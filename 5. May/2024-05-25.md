#### ë‚ ì§œ: 2024-05-25

<br/>

### ğŸŒ¤ï¸ ìŠ¤í¬ëŸ¼

- í•™ìŠµ ëª©í‘œ 1 : Thread ì´í•´í•˜ê¸°

<br/>

### âš¡ï¸ ìƒˆë¡œ ë°°ìš´ ë‚´ìš©

#### [JAVA] Thread

ì½”ë“œì˜ ì—¬ëŸ¬ ë¶€ë¶„ì´ ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” êµ¬ì¡°ë¥¼ ë§Œë“¤ê¸° ìœ„í•œ ê°ê°ì˜ ì²˜ë¦¬ íë¦„

> ì½”ë“œì—ì„œ ì²˜ë¦¬ íë¦„(ìŠ¤ë ˆë“œ)ì„ ëŠ˜ë¦¬ëŠ” í–‰ìœ„ë¥¼ "**ìŠ¤ë ˆë“œë¥¼ ê¸°ë™í•œë‹¤**" ë¼ê³  í•œë‹¤.

- **ìŠ¤ë ˆë“œê°€ í•„ìš”í•œ ì´ìœ **

  ë©€í‹°íƒœìŠ¤í‚¹(ì—¬ëŸ¬ ì‘ì—…(í”„ë¡œì„¸ìŠ¤)ì„ ë™ì‹œì— ì²˜ë¦¬)ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´  
  â†’ ë°˜ë³µë¬¸ìœ¼ë¡œ ë™ì‘í•˜ëŠ”, ë§¤ìš° ì˜¤ëœ ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì‘ì—…ì´ ìˆ˜í–‰ë˜ëŠ” ë„ì¤‘ì— ë‹¤ë¥¸ ìŠ¤ë ˆë“œì— ì˜í•´ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.

  - IO ì‘ì—…ì´ ë§ì€ ê²½ìš°  
    íŒŒì¼ ì½ê¸°/ì“°ê¸°, ë„¤íŠ¸ì›Œí¬ í†µì‹  ë“±ì˜ ëŒ€ê¸° ì‹œê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ìœ„í•´
  - UI ì‘ë‹µì„± í–¥ìƒ  
    GUI í”„ë¡œê·¸ë¨ì—ì„œ ì‚¬ìš©ìì˜ ì…ë ¥ì„ ë°›ëŠ” ë™ì•ˆì—ë„ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•´
  - ë³‘ë ¬ ì²˜ë¦¬  
    ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ìˆ˜í–‰í•˜ì—¬ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´

- **ìŠ¤ë ˆë“œ ê¸°ë™í•˜ê¸°**

  - `Thread` í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì•„ í™•ì¥í•˜ì—¬ ì‚¬ìš©

    ```java
    class MyThread extends Thread {
      public void run() {
        // ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•  ì½”ë“œ
      }
    }

    public class Main {
      public static void main(String[] args) {
        MyThread t = new MyThread();
        t.start(); // ìŠ¤ë ˆë“œ ê¸°ë™
      }
    }
    ```

  - `Runnable` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ì‚¬ìš©

    - ìë°”ì—ì„œëŠ” ë‹¤ì¤‘ ìƒì†ì„ ì§€ì›í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, ì´ë¯¸ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì€ ê²½ìš° `Runnable` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬ ì‚¬ìš©í•œë‹¤.
    - ìŠ¤ë ˆë“œì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë¶„ë¦¬í•˜ì—¬ ì½”ë“œì˜ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤.

    ```java
    class MyThread implements Runnable {
      @Override
      public void run() {
        // ìŠ¤ë ˆë“œê°€ ì‹¤í–‰í•  ì½”ë“œ
      }
    }

    public class Main {
      public static void main(String[] args) {
        MyThread t = new MyThread();
        Thread thread = new Thread(t);
        thread.start(); // ìŠ¤ë ˆë“œ ê¸°ë™
      }
    }
    ```

  - Thread í´ë˜ìŠ¤ë¥¼ í™•ì¥í•œ í´ë˜ìŠ¤ëŠ” ë°˜ë“œì‹œ ê·¸ ì•ˆì— run() ë©”ì†Œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•´ì•¼ í•œë‹¤.
  - `start()` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ìƒˆë¡œìš´ ìŠ¤ë ˆë“œê°€ ìƒì„±ë˜ê³ , `run()` ë©”ì†Œë“œê°€ ì‹¤í–‰ëœë‹¤.

  <details>
  <summary>ìŠ¤ë ˆë“œì˜ ì‹¤í–‰ ê³¼ì • ì˜ˆì‹œ</summary>

  ```java
  public class MainThreadHome {
      public static void main(String[] args) {
          // ê°€ì¡± êµ¬ì„±ì›ì´ í•´ì•¼í•˜ëŠ” ì‘ì—…ì„ ìƒì„±
          Task cleaning = new Task("ì§‘ ì²­ì†Œ");
          Task cooking = new Task("ìš”ë¦¬");
          Task takingOutTrash = new Task("ì“°ë ˆê¸° ë²„ë¦¬ê¸°");
          Task laundry = new Task("ì„¸íƒ");

          // ê° ì‘ì—…ì„ ìˆ˜í–‰í•  ì‚¬ëŒ(ìŠ¤ë ˆë“œ)ì„ ìƒì„±
          Thread father = new Thread(cleaning);
          Thread mother = new Thread(cooking);
          Thread son = new Thread(takingOutTrash);
          Thread daughter = new Thread(laundry);

          // ê° êµ¬ì„±ì›ì˜ ì‘ì—…ì„ ì‹œì‘
          // ìŠ¤ë ˆë“œ ê°ì²´ì—ì„œ start() í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ë©´ JVMì— ì˜í•´ì„œ ìŠ¤ë ˆë“œê°€ ë§Œë“¤ì–´ì§€ê²Œ ëœë‹¤.
          // ê·¸ í›„ JVM ì€ ìƒì„±í•œ ìŠ¤ë ˆë“œ ë‚´ë¶€ì— `@Override` ëœ run() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.
          father.start();
          mother.start();
          son.start();
          daughter.start();
      }
  }
  ```

  ```java
  // ì‘ì—…ì„ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ (Runnableì€ Threadì— ë°°ì •ëœë‹¤.)
  class Task implements Runnable {
      private String taskName;

      // ìƒì„±ì
      public Task(String taskName) {
          this.taskName = taskName;
      }

      // run ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ ì‘ì—…ì„ ì •ì˜
      // ì½œëŸ¬ì¸¡ì—ì„œ start() í•¨ìˆ˜ ì‹¤í–‰ ì‹œ JVMì—ì„œ ìŠ¤ë ˆë“œë¥¼ í• ë‹¹í•˜ê³  í•´ë‹¹ ê°ì²´ì˜ run() ë©”ì„œë“œë¥¼ ì‹¤í–‰ ì‹œí‚¤ê²Œ ëœë‹¤.
      @Override
      public void run() {
          System.out.println(taskName + "ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.");
          try {
              // ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„(ì˜ˆ: 2ì´ˆ)
              Thread.sleep(2000);
          } catch (InterruptedException e) {
              System.out.println(taskName + " ì‘ì—… ì¤‘ë‹¨ë¨");
          }
          System.out.println(taskName + "ë¥¼ ëëƒˆìŠµë‹ˆë‹¤.");
      }
  }
  ```

  ![sequence](img/20240525_1.png)

  </details>
  <br/>

- **ìŠ¤ë ˆë“œì˜ ë©”ëª¨ë¦¬ ê³µìœ **

  - ìŠ¤ë ˆë“œëŠ” í”„ë¡œì„¸ìŠ¤ ë‚´ì˜ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•œë‹¤.
  - ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì¼í•œ ê°ì²´ë¥¼ ê³µìœ í•˜ë©´ì„œ ê·¸ ê°ì²´ì˜ ìƒíƒœë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

  ```java
  // ê³µìœ  ë°ì´í„°ë¥¼ ê°€ì§„ í´ë˜ìŠ¤
  class SharedCounter {
    public int count = 0; // ê³µìœ  ë°ì´í„°

    public synchronized void increment() {
      count++;
      System.out.println(Thread.currentThread().getName() + ": " + count);
    }

    public int getCount() {
      return count;
    }
  }

  // ìŠ¤ë ˆë“œ í´ë˜ìŠ¤
  class MyThread extends Thread {
    private SharedCounter sharedCounter; // ê³µìœ  ë°ì´í„°ë¥¼ ê°€ì§„ ê°ì²´

    public MyThread(sharedCounter sharedCounter) { // ìƒì„±ìì—ì„œ ê³µìœ  ë°ì´í„°ë¥¼ ë°›ìŒ
      this.sharedCounter = sharedCounter;
    }

    @Override
    public void run() {
      for (int i = 0; i < 50; i++) {
        sharedCounter.increment();

        try {
          Thread.sleep(100);
        } catch (InterruptedException e) {
          e.printStackTrace();
        }
      }
    }
  }

  public class Main {
    public static void main(String[] args) {
      SharedCounter sharedCounter = new SharedCounter(); // ê³µìœ  ë°ì´í„° ê°ì²´ ìƒì„±

      MyThread t1 = new MyThread(sharedCounter); // ê³µìœ  ë°ì´í„° ê°ì²´ë¥¼ ìŠ¤ë ˆë“œì— ì „ë‹¬
      MyThread t2 = new MyThread(sharedCounter);

      t1.start(); // ìŠ¤ë ˆë“œ ì‹œì‘
      t2.start();

      try {
        t1.join(); // ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
        t2.join();
      } catch (InterruptedException e) {
        e.printStackTrace();
      }

      System.out.println("ìµœì¢… ì¹´ìš´íŠ¸: " + sharedCounter.getCount());
    }
  }
  ```

  ```
  // ì¶œë ¥ ê²°ê³¼
  Thread-0: 1
  Thread-1: 2
  Thread-0: 3
  Thread-1: 4
  ...
  ìµœì¢… ì¹´ìš´íŠ¸: 100
  ```

  - ìœ„ ì½”ë“œì—ì„œ `SharedCounter` í´ë˜ìŠ¤ëŠ” ê³µìœ  ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, `increment()` ë©”ì†Œë“œë¥¼ í†µí•´ ê³µìœ  ë°ì´í„°ë¥¼ ì¦ê°€ì‹œí‚¨ë‹¤.
  - ë§Œì•½ ìŠ¤ë ˆë“œë“¤ì´ ë©”ëª¨ë¦¬ ê³µê°„ì„ ê³µìœ í•˜ì§€ ì•Šê³ , ê°ê°ì˜ ë©”ëª¨ë¦¬ ê³µê°„ì„ ê°€ì§€ê³  ìˆë‹¤ë©´, ìµœì¢… ì¹´ìš´íŠ¸ëŠ” ì–¸ì œë‚˜ 50ì´ ë  ê²ƒì´ë‹¤.
  - í•˜ì§€ë§Œ 100 ì´í•˜ì˜ ìˆ«ìê°€ ì¶œë ¥ë˜ëŠ” ê²½ìš°ê°€ ë°œìƒí•œë‹¤.
    - ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ synchronized í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì†Œë“œì— ë™ê¸°í™”ë¥¼ ê±¸ì–´ì¤€ë‹¤.
    - [`ë ˆì´ìŠ¤ ì»¨ë””ì…˜(Race Condition)`](https://github.com/yoouung/TIL-KCS/blob/main/May/2024-05-26.md)

- **ìŠ¤ë ˆë“œì˜ ì¡°ì‘**

  - `join()` ë©”ì†Œë“œ

    - ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ë©”ì†Œë“œ
    - `join()` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œ ìŠ¤ë ˆë“œëŠ” ëŒ€ê¸° ìƒíƒœê°€ ë˜ë©°, ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë˜ë©´ ì‹¤í–‰ì„ ì¬ê°œí•œë‹¤.

    ```java
    public class Main {
      public static void main(String[] args) {
        MyThread t = new MyThread();
        t.start();

        try {
          t.join(); // t ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¼
        } catch (InterruptedException e) {
          e.printStackTrace();
        }

        System.out.println("ë©”ì¸ ìŠ¤ë ˆë“œ ì¢…ë£Œ");
      }
    }
    ```

  - `sleep()` ë©”ì†Œë“œ

    - ì¼ì • ì‹œê°„ ë™ì•ˆ ìŠ¤ë ˆë“œë¥¼ ëŒ€ê¸° ìƒíƒœë¡œ ë§Œë“œëŠ” ë©”ì†Œë“œ
    - ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ ì‹œê°„ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

    ```java
    Class MyThread extends Thread {
      public void run() {
        for (int i = 0; i < 10; i++) {
          System.out.println(i);

          try {
            Thread.sleep(1000); // 1ì´ˆ ëŒ€ê¸°
          } catch (InterruptedException e) {
            e.printStackTrace();
          }

        }
      }
    }
    ```

  - `interrupt()` ë©”ì†Œë“œ

    - ìŠ¤ë ˆë“œë¥¼ ê°•ì œë¡œ ì¢…ë£Œì‹œí‚¤ëŠ” ë©”ì†Œë“œ
    - ìŠ¤ë ˆë“œê°€ `sleep()` ë©”ì†Œë“œ ë“±ìœ¼ë¡œ ëŒ€ê¸° ìƒíƒœì— ìˆì„ ë•Œ, `interrupt()` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ë©´ `InterruptedException` ì˜ˆì™¸ê°€ ë°œìƒí•˜ì—¬ ìŠ¤ë ˆë“œê°€ ì¢…ë£Œëœë‹¤.

    ```java
    public class Main {
      public static void main(String[] args) {
        MyThread t = new MyThread();
        t.start();

        try {
          Thread.sleep(1000);
          t.interrupt(); // t ìŠ¤ë ˆë“œ ê°•ì œ ì¢…ë£Œ
        } catch (InterruptedException e) {
          e.printStackTrace();
        }

        System.out.println("ë©”ì¸ ìŠ¤ë ˆë“œ ì¢…ë£Œ");
      }
    }
    ```

<br/>

### ~~ğŸ”¥ ì˜¤ëŠ˜ì˜ ë„ì „ ê³¼ì œì™€ í•´ê²° ë°©ë²•~~

<br/>

### ğŸ¤” ì˜¤ëŠ˜ì˜ íšŒê³ 

- ìŠ¤í¬ëŸ¼ ì¤‘ ì™„ë£Œí•œ ì‘ì—…: `ì™„ë£Œí•œ ì‘ì—…`
- ì„±ê³µì ì¸ ì , ê°œì„ í•´ì•¼ í•  ì , ìƒˆë¡­ê²Œ ì‹œë„í•˜ê³  ì‹¶ì€ ë°©ë²• ë“±ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br/>

### ì°¸ê³  ìë£Œ ë° ë§í¬

- [ê·¸ë¦¼ìœ¼ë¡œ ë°°ìš°ëŠ” ìë°” í”„ë¡œê·¸ë˜ë°] 15. ìŠ¤ë ˆë“œ
