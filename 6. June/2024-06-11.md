#### ë‚ ì§œ: 2024-06-11

<br/>

### ğŸŒ¤ï¸ ìŠ¤í¬ëŸ¼

-   í•™ìŠµ ëª©í‘œ 1 : JPA ë§¤í•‘ ì´í•´í•˜ê¸°

<br/>

### âš¡ï¸ ìƒˆë¡œ ë°°ìš´ ë‚´ìš©

#### [Spring Boot] JPA ë§¤í•‘

-   **Entity ë§¤í•‘**

    -   `@Entity`  
        í…Œì´ë¸”ê³¼ ë§¤í•‘í•  í´ë˜ìŠ¤ì— ì‚¬ìš©
    -   `@Table`
        ì—”í‹°í‹°ì™€ ë§¤í•‘í•  í…Œì´ë¸”ì„ ì§€ì •
    -   `@Column`
        í•„ë“œì™€ ë§¤í•‘í•  í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì„ ì§€ì •
    -   `@Enumerated`
        ìë°” enum íƒ€ì…ì„ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
    -   `@Temporal`
        ë‚ ì§œ íƒ€ì…ì„ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
    -   `@Transient`
        íŠ¹ì • í•„ë“œë¥¼ DBì— ë§¤í•‘í•˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©
    -   `@Access`
        ì—”í‹°í‹°ì˜ í•„ë“œì— ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì„ ì§€ì •
        -   `AccessType.FIELD`  
            í•„ë“œì— ì§ì ‘ ì ‘ê·¼
        -   `AccessType.PROPERTY`  
            getterë¥¼ ì‚¬ìš©í•˜ì—¬ ì ‘ê·¼
        -   `AccessType.FIELD`  
            í•„ë“œì™€ getterë¥¼ ëª¨ë‘ ì‚¬ìš©í•˜ì—¬ ì ‘ê·¼

-   **ê¸°ë³¸ í‚¤ ë§¤í•‘**

    -   `@Id`
        ì—”í‹°í‹°ì˜ ê¸°ë³¸ í‚¤ë¥¼ ì§€ì •
    -   `@GeneratedValue`
        ê¸°ë³¸ í‚¤ì˜ ê°’ì„ ìë™ ìƒì„±

        -   `GenerationType.AUTO`  
            DBì— ë”°ë¼ ìë™ ì§€ì •
        -   `GenerationType.IDENTITY`  
            ê¸°ë³¸ í‚¤ ìƒì„±ì„ DBì— ìœ„ì„
            -   ì£¼ë¡œ MySQL, PostgreSQL, SQL Server, DB2ì—ì„œ ì‚¬ìš©í•œë‹¤.
        -   `GenerationType.SEQUENCE`  
            DB ì‹œí€€ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ í‚¤ ìƒì„±

            <details>
            <summary>DB ì‹œí€€ìŠ¤ë€?</summary>
            ìœ ì¼í•˜ê³  ìˆœì°¨ì ì¸ ìˆ«ì ê°’ì„ ìƒì„±í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¸Œì íŠ¸

            -   ì£¼ë¡œ ê¸°ë³¸ í‚¤ì™€ ê°™ì€ ìœ ì¼í•œ ì‹ë³„ìë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©ëœë‹¤.
            </details>

            -   ì£¼ë¡œ Oracle, PostgreSQL, DB2, H2ì—ì„œ ì‚¬ìš©í•œë‹¤.

        -   `GenerationType.TABLE`  
            í‚¤ ìƒì„± ì „ìš© í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ í‚¤ ìƒì„±

-   **ì—°ê´€ê´€ê³„ ë§¤í•‘**

    -   `@ManyToOne`
        ë‹¤ëŒ€ì¼ ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
    -   `@OneToMany`
        ì¼ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
        -   `mappedBy`
            ì—°ê´€ë˜ëŠ” ì—”í‹°í‹°ì˜ í•„ë“œëª…ì„ ì§€ì •
    -   `@OneToOne`
        ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
    -   `@ManyToMany`
        ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
    -   `@JoinColumn`
        ì™¸ë˜í‚¤ ë§¤í•‘ì— ì‚¬ìš©

    <br/>

    -   **ë‹¨ë°©í–¥, ì–‘ë°©í–¥ ë§¤í•‘**

        -   **`ë‹¨ë°©í–¥`**  
            í•œ ì—”í‹°í‹°ë§Œ ì°¸ì¡°í•˜ëŠ” ê²ƒ
            ![oneway](img/20240611_1.png)

            `Member.java`

            ```java
            @Entity
            public class Member {
                @Id
                @GeneratedValue
                @Column(name = "member_id")
                private Long id;

                @Column(name = "username")
                private String name;

                @ManyToOne // Memberê°€ ì—¬ëŸ¬ê°œ, Teamì´ í•˜ë‚˜
                @JoinColumn(name = "team_id")
                private Team team;
            }
            ```

            Team ì—”í‹°í‹°ë¥¼ ë©¤ë²„ ë³€ìˆ˜ë¡œ ë“±ë¡í•˜ì—¬ ì—”í‹°í‹° ê°„ ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.

            `Team.java`

            ```java
            @Entity
            public class Team {
                @Id
                @GeneratedValue
                @Column(name = "team_id")
                private Long id;

                @Column(name = "teamname")
                private String name;
            }
            ```

            `Main.java`

            ```java
            Team team = new Team();
            team.setName("TeamA");
            em.persist(team);

            Member member = new Member();
            member.setName("member1");
            member.setTeam(team);
            em.persist(member);
            ```

            Member ì—”í‹°í‹°ì— Team ì—”í‹°í‹°ë¥¼ ë“±ë¡í•˜ì—¬ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.

            <br/>

        -   **`ì–‘ë°©í–¥`**
            ë‘ ì—”í‹°í‹°ê°€ ì„œë¡œ ì°¸ì¡°í•˜ëŠ” ê²ƒ

            -   ê·œì¹™
                -   ê°ì²´ì˜ ë‘ ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì—°ê´€ê´€ê³„ ì£¼ì¸ìœ¼ë¡œ ì§€ì •í•œë‹¤.
                -   ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬(ë“±ë¡, ìˆ˜ì •)í•œë‹¤.
                -   ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ ì½ê¸°ë§Œ ê°€ëŠ¥í•˜ë‹¤.
                -   ì£¼ì¸ì€ mappedBy ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
                -   ì£¼ì¸ì´ ì•„ë‹Œ ìª½ì€ mappedBy ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ì£¼ì¸ì„ ì§€ì •í•œë‹¤.

            ![bothway](img/20240611_2.png)

            `Member.java`

            ```java
            @Entity
            public class Member {
                @Id
                @GeneratedValue
                @Column(name = "member_id")
                private Long id;

                @Column(name = "username")
                private String name;

                @ManyToOne
                @JoinColumn(name = "team_id")
                private Team team;
            }
            ```

            `Team.java`

            ```java
            @Entity
            public class Team {
                @Id
                @GeneratedValue
                @Column(name = "team_id")
                private Long id;

                @Column(name = "teamname")
                private String name;

                @OneToMany(mappedBy = "team") // Member ì—”í‹°í‹°ì˜ team í•„ë“œì™€ ë§¤í•‘
                private List<Member> members = new ArrayList<>();

                public List<Member> getMembers() {
                    return members;
                }
            }
            ```

            ì—°ê´€ë˜ëŠ” ì„œë¡œì˜ ê°ì²´ë¥¼ ë©¤ë²„ ë³€ìˆ˜ë¡œ ë“±ë¡í•˜ì—¬ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.

            `Main.java`

            ```java
            Team team = new Team();
            team.setName("TeamA");
            em.persist(team);

            Member member = new Member();
            member.setName("member1");

            team.getMembers().add(member);
            member.setTeam(team);

            Member findMember = em.find(Member.class, member.getId()); // ì¡°íšŒ
            List<Members> members = findMember.getTeam().getMembers();

            for (Member m : members) {
                System.out.println("member.name = " + m.getName());
            }
            ```

            `Member` ì—”í‹°í‹°ì˜ `team` í•„ë“œì™€ `Team` ì—”í‹°í‹°ì˜ `members` í•„ë“œë¥¼ ì„œë¡œ ì°¸ì¡°í•˜ë„ë¡ ì„¤ì •í•˜ì—¬ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.

            <br/>

        -   `ì£¼ì¸`
            ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ì—”í‹°í‹°
            -   ê°ì²´ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ëŠ” ê´€ë¦¬ ì£¼ì²´ê°€ í•„ìš”í•˜ë‹¤.

<br/>

### ğŸ”¥ ì˜¤ëŠ˜ì˜ ë„ì „ ê³¼ì œì™€ í•´ê²° ë°©ë²•

#### ë„ì „ ê³¼ì œ 1: MySQLê³¼ ìŠ¤í”„ë§ ì—°ë™í•˜ê¸°

-   **í”„ë¡œì íŠ¸ êµ¬ì„±**

    -   `Entity`
        ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤. ì£¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì˜ êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

        -   ì˜ˆì‹œ: User í´ë˜ìŠ¤ëŠ” users í…Œì´ë¸”ê³¼ ë§¤í•‘ë©ë‹ˆë‹¤.

    -   `Repository`
        ë°ì´í„°ë² ì´ìŠ¤ì™€ ì§ì ‘ ì†Œí†µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì…ë‹ˆë‹¤. CRUD (ìƒì„±, ì½ê¸°, ì—…ë°ì´íŠ¸, ì‚­ì œ) ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

        -   ì˜ˆì‹œ: UserRepository ì¸í„°í˜ì´ìŠ¤ëŠ” User ì—”í„°í‹°ì— ëŒ€í•œ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

    -   `DTO` (Data Transfer Object)
        ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì„œë¹„ìŠ¤ ê°„ì˜ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ê°ì²´ì…ë‹ˆë‹¤. ì£¼ë¡œ ë·°ì™€ ì»¨íŠ¸ë¡¤ëŸ¬ ê°„ì˜ ë°ì´í„° êµí™˜ì— ì‚¬ìš©ë©ë‹ˆë‹¤.

        -   ì˜ˆì‹œ: UserDTO í´ë˜ìŠ¤ëŠ” í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì…ë ¥ ë°›ì€ ë°ì´í„°ë¥¼ ì„œë¹„ìŠ¤ ê³„ì¸µì— ì „ë‹¬í•˜ê±°ë‚˜, ì„œë¹„ìŠ¤ ê³„ì¸µì—ì„œ ì²˜ë¦¬ëœ ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.

    -   `Service`
        ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” í´ë˜ìŠ¤ì…ë‹ˆë‹¤. ì£¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì™€ì˜ ìƒí˜¸ì‘ìš©ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.
        -   ì˜ˆì‹œ: UserService í´ë˜ìŠ¤ëŠ” User ì—”í„°í‹°ì— ëŒ€í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

    <br/>

    > _ë¡œì§ ì˜ˆì‹œ_  
    > `UserDTO` (-> `UserEntity`) -> `UserService` -> `UserRepository` -> MySQL ë°ì´í„°ë² ì´ìŠ¤
    >
    > 1. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ìš”ì²­ì„ ë°›ëŠ”ë‹¤.
    >    ì˜ˆë¥¼ ë“¤ì–´, íšŒì›ê°€ì… ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´, ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” `UserDTO` ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ì…ë ¥ ë°ì´í„°ë¥¼ ë°›ëŠ”ë‹¤.
    > 2. ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë°›ì€ ë°ì´í„°ë¥¼ ì„œë¹„ìŠ¤ ê³„ì¸µìœ¼ë¡œ ì „ë‹¬í•œë‹¤.
    >    `UserDTO` ê°ì²´ë¥¼ `UserEntity` ì—”í„°í‹°ë¡œ ë³€í™˜í•˜ì—¬ `UserService` ê³„ì¸µìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.
    > 3. ì„œë¹„ìŠ¤ ê³„ì¸µì€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•œë‹¤.
    >    `UserService` ì—ì„œ `UserRepository`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.
    >    ì˜ˆë¥¼ ë“¤ì–´, ìƒˆë¡œìš´ ìœ ì €ë¥¼ ìƒì„±í•˜ê³  ì €ì¥í•œë‹¤.
    > 4. ë ˆí¬ì§€í† ë¦¬ê°€ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì†Œí†µí•œë‹¤.
    >    `UserRepository`ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì— ì ‘ê·¼í•˜ì—¬ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.
    >    ì˜ˆë¥¼ ë“¤ì–´, ìƒˆë¡œìš´ ìœ ì € ì •ë³´ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•œë‹¤.

<br/>

### ğŸ¤” ì˜¤ëŠ˜ì˜ íšŒê³ 

-   ìŠ¤í¬ëŸ¼ ì¤‘ ì™„ë£Œí•œ ì‘ì—…: `JPA ë§¤í•‘ ì´í•´í•˜ê¸°`
-   JPAë¥¼ ì§ì ‘ ì½”ë“œì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ì™€ ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•˜ëŠ” ë°©ë²•ì„ ì•Œê²Œ ë˜ì—ˆë‹¤. ì–‘ë°©í–¥ ë§¤í•‘ì„ ì‚¬ìš©í•˜ë©´ ê°ì²´ ê°„ì˜ ê´€ê³„ë¥¼ ë”ìš± ìœ ì—°í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. ì´ì œ MySQLê³¼ ìŠ¤í”„ë§ì„ ì—°ë™í•˜ì—¬ ì‹¤ì œë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ì¡°íšŒí•˜ëŠ” ì‘ì—…ì„ í•´ë³´ê³  ì‹¶ë‹¤.

<br/>

### ì°¸ê³  ìë£Œ ë° ë§í¬

-   [JPAì™€ DB ì—°ê´€ê´€ê³„](https://velog.io/@heyday_7/JPA%EC%99%80-DB-relation)
-   [JPA ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸, ì–‘ë°©í–¥ ë§¤í•‘ ì •ë¦¬](https://scoring.tistory.com/entry/JPA-%EC%96%91%EB%B0%A9%ED%96%A5-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84%EC%99%80-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84%EC%9D%98-%EC%A3%BC%EC%9D%B8-%EC%96%91%EB%B0%A9%ED%96%A5-%EB%A7%A4%ED%95%91-%EC%A0%95%EB%A6%AC)
-   [MySQL DBì™€ ì—°ë™í•˜ê¸°](https://changha-dev.tistory.com/147)
