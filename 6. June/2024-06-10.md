#### ë‚ ì§œ: 2024-06-10

<br/>

### ğŸŒ¤ï¸ ìŠ¤í¬ëŸ¼

-   í•™ìŠµ ëª©í‘œ 1 : JPA ì´í•´í•˜ê¸°

<br/>

### âš¡ï¸ ìƒˆë¡œ ë°°ìš´ ë‚´ìš©

#### [Spring Boot] JPA

Java Persistance API
ìë°” ê°ì²´ë¥¼ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ë§¤í•‘í•˜ê¸° ìœ„í•œ ORM(Object Relational Mapping) ê¸°ìˆ 

> **Entity:** ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ë§¤í•‘ë˜ëŠ” ìë°” ê°ì²´
> **ORM:** ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë°ì˜ ê°ì²´ë¥¼ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ìˆ 

-   ì‚¬ìš© ì´ìœ 

    -   ì§ì ‘ SQL ì¿¼ë¦¬ë¥¼ ì‘ì„±í•  í•„ìš” ì—†ì´ ìë°” ì½”ë“œë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
    -   ì½”ë“œì˜ ê°€ë…ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì´ ë†’ì•„ì§„ë‹¤.
    -   ê°ì²´ ì§€í–¥ì ì¸ ì ‘ê·¼ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ í•  ìˆ˜ ìˆë‹¤.

-   ì—”í‹°í‹° í´ë˜ìŠ¤ ì •ì˜
    `ê¸°ì¡´ User í´ë˜ìŠ¤`

    ```java
    public class User {
        private Long id;
        private String name;
        private String email;
        private String phone;
        private Department department;
    }
    ```

    `JPA Entity í´ë˜ìŠ¤`

    ```java
    @Entity // JPA Entity í´ë˜ìŠ¤ì„ì„ ëª…ì‹œ
    @Table(name = "users") // users í…Œì´ë¸”ê³¼ ë§¤í•‘
    public class User {
        @Id // Primary Key(ê¸°ë³¸í‚¤)
        @GeneratedValue(strategy = GenerationType.IDENTITY) // ê¸°ë³¸í‚¤ ìë™ ìƒì„±
        private Long id;

        @Column(name = "name", nullable = false) // ì»¬ëŸ¼ ì„¤ì •
        private String name;

        @Column(name = "email", nullable = false)
        private String email;

        @Column(name = "phone", nullable = false)
        private String phone;

        @OneToOne(mappedBy = "user", cascade = CascadeType.ALL) // 1:1 ê´€ê³„ ì„¤ì •, cascade: ì—°ê´€ëœ ì—”í‹°í‹°ì˜ ìƒíƒœ ë³€ê²½ ì „íŒŒ
        private Department department;

        // ê¸°ë³¸ ìƒì„±ì
        public User() {}
        }
    ```

    `ê¸°ì¡´ Department í´ë˜ìŠ¤`

    ```java
    @Getter
    @Setter
    public class Department {
        private String departmentName;

        public Department(String departmentName) {
            this.departmentName = departmentName;
        }
    }
    ```

    `JPA ì ìš© Department í´ë˜ìŠ¤`

    ```java
    @Entity
    @Table(name = "departments")
    public class Department {
        @Id
        @GeneratedValue(strategy = GenerationType.IDENTITY)
        private Long id;

        @Column(name = "department_name", nullable = false)
        private String departmentName;

        @OneToOne
        @JoinColumn(name = "user_id") // ì™¸ë˜í‚¤ ì„¤ì •
        private User user;

        public Department() {}
    }
    ```

<br/>

### ğŸ”¥ ì˜¤ëŠ˜ì˜ ë„ì „ ê³¼ì œì™€ í•´ê²° ë°©ë²•

#### ë„ì „ ê³¼ì œ 1: expressì—ì„œ SQL ì¿¼ë¦¬ ë‚ ë¦¬ê¸°

`?`ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬í•˜ëŠ” SQL ì¿¼ë¦¬

```javascript
const sql = "SELECT * FROM users WHERE id = ?";
connection.query(sql, [userId], (err, results) => {
    if (err) {
        console.error(err);
        return;
    }
    console.log(results);
});
```

```javascript
const sql = "INSERT INTO users (name, email) VALUES (?, ?)";
connection.query(sql, [name, email], (err, results) => {
    if (err) {
        console.error(err);
        return;
    }
    console.log(results);
});
```

-   ì¥ì 
    -   SQL Injection ê³µê²©ì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤.
    -   ì½”ë“œì˜ ê°€ë…ì„±ì´ ë†’ì•„ì§„ë‹¤.
    -   ë¯¸ë¦¬ ì»´íŒŒì¼ë˜ê±°ë‚˜ ìºì‹±ë  ìˆ˜ ìˆì–´, ì¿¼ë¦¬ ì‹¤í–‰ ì†ë„ê°€ ë¹¨ë¼ì§„ë‹¤.

<br/>

> â—ï¸ ê°’ì„ ì§ì ‘ ëŒ€ì…í•˜ëŠ” ê²½ìš°, ì‚¬ìš©ì ì…ë ¥ê°’ì´ ê·¸ëŒ€ë¡œ ì¿¼ë¦¬ ë¬¸ìì—´ì— í¬í•¨ë˜ì–´ SQL Injection ê³µê²©ì— ì·¨ì•½í•˜ë‹¤.
>
> ```javascript
> const sql = `SELECT * FROM users WHERE id = ${userId}`;
> connection.query(sql, (err, results) => {
>     if (err) {
>         console.error(err);
>         return;
>     }
>     console.log(results);
> });
> ```

---

jeff said..

```
1. ë°ì´í„°ë² ì´ìŠ¤ì˜ ì •ë³´ ì‚­ì œ í•  ë•ŒëŠ” Soft-Delete ë°©ì‹ê³¼ Hard-Delete ë°©ì‹ì´ ìˆìŠµë‹ˆë‹¤.
2. ë°ì´í„°ë² ì´ìŠ¤ì˜ ìë£ŒëŠ” íšŒì‚¬ ì…ì¥ì—ì„  í˜„ê¸ˆê³¼ ë™ì¼í•©ë‹ˆë‹¤. ë²•ì ì¸ ì´ìŠˆê°€ ì‹¬ê°í•˜ì§€ ì•Šì€ ì´ìƒ ì§€ì›Œì•¼ í•  ì´ìœ ëŠ” í¬ê²Œ ì—†ìŠµë‹ˆë‹¤.
  â†’ ì•„ì²­ë²• ìœ„ë°˜ ê²Œì‹œë¬¼ì„ ì˜¬ë¦° ìœ ì €ì˜ ê°œì¸ì •ë³´ë¥¼ ê²€ì°°ì—ì„œ ìš”êµ¬í•˜ëŠ” ê²½ìš° ì„œë¹„ìŠ¤ ì œê³µì—…ìëŠ” ì´ìœ  ì—†ì´ ì œê³µì„ ê±°ë¶€ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
3. ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ëŠ” ë°ì´í„°ê°€ ë¡œê·¸ë°ì´í„°ê°€ ì•„ë‹ˆë¼ ìœ ì €ì— ì˜í•´ì„œ ë°œìƒí•œ ë°ì´í„°ë¼ë©´ ê±°ëŒ€í•´ì ¸ë„ ìƒê´€ ì—†ìŠµë‹ˆë‹¤. í”„ë¡œì íŠ¸ê°€ ì´ˆê¸°ë¥¼ ë„˜ì–´ ì¤‘ê¸°ë¡œ ë„˜ì–´ê°„ë‹¤ê³  í•´ë„ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì•„ë¬´ë¦¬ ì»¤ë„ 100ê¸°ê°€ ë„˜ëŠ”ê±´ ì—„ì²­ë‚˜ê²Œ í˜ë“­ë‹ˆë‹¤. (ë¬¼ë¡  ìˆ˜ì§‘í•˜ëŠ” ë°ì´í„°ì˜ ì¢…ë¥˜ì™€ ì–‘ì— ë”°ë¼ ë‹¤ë¥´ê² ì§€ë§Œ í†µìƒì ìœ¼ë¡œ..)
```

<br/>

### ğŸ¤” ì˜¤ëŠ˜ì˜ íšŒê³ 

-   ìŠ¤í¬ëŸ¼ ì¤‘ ì™„ë£Œí•œ ì‘ì—…: `SQL íŒŒë¼ë¯¸í„°í™” ì¿¼ë¦¬ ì´í•´í•˜ê¸°`, `JPA ì´í•´í•˜ê¸°`
-   mysql ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ expressì—ì„œ SQL ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•´ë´¤ë‹¤.
-   ê·¸ë¦¬ê³  SQL ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ê°ì²´ ì§€í–¥ì ì¸ ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” JPAì— ëŒ€í•´ ê³µë¶€í–ˆë‹¤.

<br/>

### ì°¸ê³  ìë£Œ ë° ë§í¬

-   ì œí‘¸ì˜ ê°•ì˜ìë£Œ
